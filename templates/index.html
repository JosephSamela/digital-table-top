<!DOCTYPE html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- CSS Libraries -->
    <link rel="stylesheet" href="static/css/uikit.min.css" />
    <link rel="stylesheet" href="static/css/bulma.min.css" />
    <!-- Javascript Libraries -->
    <script src="static/js/uikit.min.js"></script>
    <script src="static/js/uikit-icons.min.js"></script>
    <script src="static/js/jquery.min.js"></script>
    <script src="static/js/socket.io.dev.js"></script>
    <!-- Page Decorations -->
    <title>Table Top</title>
    <link rel="shortcut icon" type="image/png" href="/static/images/favicon.png" />
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/static/images/favicon.png">
    <link rel="apple-touch-icon" type="image/png" href="/static/images/favicon.png">
    <link rel="icon" type="image/png" href="/static/images/favicon.png">
</head>

<style>
    body {
        padding: 0px;
    }

    .column {
        height: 100vh;
        overflow-y: scroll;
        padding-bottom: 0px;
    }

    .columns {
        margin: 0px;
    }

    audio {
        margin-top: 4em;
        /* display:block; */
    }

    /* .uk-card-title {
        margin-bottom: 2em;
    } */

    /* scrollbar */
    ::-webkit-scrollbar {
        width: 2px;
    }

    ::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
        background: #888;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: #555;
    }
</style>

<body>

    <div class="columns" style="margin-bottom: 0px;">
        <div class="column">
            <h1 class="uk-heading-divider">Maps</h1>
            <div id="static/maps/default.jpg" name="map-thumbnail" onclick="update_map(this)" class="uk-card uk-card-default uk-grid-collapse uk-child-width-1-2@s uk-margin"
                uk-grid>
                <div class="uk-flex-last@s uk-card-media-right uk-cover-container">
                    <img src="static/maps/default.jpg" alt="" uk-cover>
                    <canvas width="400" height="100"></canvas>
                </div>
                <div>
                    <div class="uk-card-body">
                        <div class="uk-card-badge uk-label">Map</div>
                        <h1 class="uk-card-title">Default</h1>
                        <p>Hide the gameboard!</p>
                    </div>
                </div>
            </div>
            {{ maps|safe }}
        </div>
        <div class="column is-hidden-mobile">
            <img id="map" src="static/maps/default.jpg">
        </div>
        <div class="column is-hidden-mobile">
            <h1 class="uk-heading-divider">ThemesüîÇ</h1>

            <!-- <div id="player1" class='uk-card uk-card-default uk-width-1-1@m uk-margin'>
                <div class='uk-card-badge uk-label'>Theme</div>
                <div class='uk-card-body'>
                    <h1 class='uk-card-title'>Default</h1>
                    <audio controls loop preload='auto' controlsList='nodownload' style='width:100%; margin-bottom: 1em;'>
                        <source id='theme' src='\static\audio\theme\Rising from the Ashes - Theme.wav'>
                    </audio>
                </div>
            </div> -->

            {{ themes|safe }}
        </div>
        <div class="column is-hidden-mobile">
            <h1 class="uk-heading-divider">EffectsüîÅ</h1>
            {{ effects|safe }}
        </div>
    </div>



</body>

<script>

    var socket = io.connect('http://' + document.domain + ':' + location.port);

    socket.on('connect', function () {
        socket.emit('message', "New connection!");
    });

    socket.on('update map', function (path) {
        console.log(path)
        highlight_map(path)
        document.getElementById("map").src = path;
    });

    function highlight_map(id) {
        // Re-color selected map blue
        var map_buttons = document.getElementsByName("map-thumbnail");
        for (i = 0; i < map_buttons.length; i++) {
            document.getElementsByName("map-thumbnail")[i].classList.remove("uk-card-primary")
        }
        document.getElementById(id).classList.add("uk-card-primary");
    }

    function update_map(element) {
        highlight_map(element.id);
        socket.emit('update map', element.id);
    }

    var player = document.getElementsByTagName("audio");
    console.log(player)
    for (var i = 0; i < player.length; i++) {
        document.getElementById(player[i].id).addEventListener('play', function (event) {
            player_play(event.path[2].id);
        });
        document.getElementById(player[i].id).addEventListener('pause', function (event) {
            player_pause(event.path[2].id);
        });
        function player_play(id) {
            document.getElementById(id).classList.add("uk-card-primary");
        }
        function player_pause(id) {
            document.getElementById(id).classList.remove("uk-card-primary");
        }
    }

</script>